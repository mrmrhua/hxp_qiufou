<!DOCTYPE html>
<html>
<head>
	<title></title>
	<style type="text/css">
		*{
			padding: 0 0;
			margin: 0 0;
			letter-spacing:  1px;
			box-sizing: border-box;
		}
		html,body{
			width: 100%;
			height: 100%;
		}
		.back{
			width: 100%;
			margin:0 auto;
			display: table-cell;
			vertical-align: middle;
		}
	</style>
	<script src="http://res.wx.qq.com/connect/zh_CN/htmledition/js/wxLogin.js"></script>
</head>
<body>
	<div style="height: 100%;background:#f5f5f5;display: table;width: 100%;">
		<div class="back">
			<div style="height:561px;width: 950px;margin: 0 auto;position: relative;">
				<img src="http://image.houxiaopang.com/qrlogin/v1.1/back.png" style="width:100%;display: block;">
				<div style="position: absolute;height:100%;width: 50%;left: 0;top: 0;">
					<img style="margin: 3% 10% 3%;" src="http://image.houxiaopang.com/first/logodown.png">
					<div style="height: 433px;width: 350px;margin: 0 auto;background: url('http://image.houxiaopang.com/qrlogin/v1.1/loginback.png') no-repeat;background-size: 100%;">
						<div id="wxqrcode" style="text-align: center;"></div>
					</div>
				</div>
				<div style="position: absolute;height:100%;width: 50%;right: 0;top: 0;">
				<div style="display: table;width: 100%;height: 100%;">
				<div style="display: table-cell;width: 100%;vertical-align: middle;background: #F2FDFB;">
					<img src="http://image.houxiaopang.com/qrlogin/v1.1/Illustration.png" style="display:block;margin: 0 auto">
				</div>
				</div>
				</div>
			</div>
		</div>
	</div>
	<script src="https://cdn.staticfile.org/jquery/3.2.1/jquery.min.js"></script>
	<script type="text/javascript">
	function getQueryString(name) {
	    var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
	    var r = window.location.search.substr(1).match(reg);
	    if (r != null) return unescape(r[2]);
	    return null;
	}
	var code = getQueryString("code");
    if (!code) {
        var obj = new WxLogin({
            id: "wxqrcode",
            appid: "wxbfacdb1b99885182",
            scope: "snsapi_login",
            redirect_uri: "http%3a%2f%2fhouxiaopang.com%2fqrlogin",
            state: "",
            style: "",
            href: ""
        });
    } else {
		$.ajax({
			url: 'http://houxiaopang.com/api/v1.1/wx_verify',
			type: "GET",
			data:{
				'code':code
			},
			success: function(result) {
				if(result.code=='0'){
	           		window.localStorage.token = result.data.token;
	            	location.href = result.data.url;
	            }else{
	            	alert('微信授权失败');
	           		location.href= "houxiaopang.com/qrlogin";
	            }
			},
			error: function() {
				alert("网络拥挤，请稍后再试。。。");
			}
		});
	}
	</script>
</body>
</html>